<!doctype html>
<html>
  <head>
    <style>
      body {
        height: 1234px;
        padding: 0;
        margin: 0;
      }
    </style>
  </head>
  <body>

    <script>
      window.onerror = function () { console.log.apply(console, arguments); };
    </script>
    <script src="../node_modules/rsvp/dist/rsvp.min.js"></script>
    <script type="text/javascript" src="../build/postmate.min.js"></script>
    <script>Postmate.Promise = RSVP.Promise;</script>
    <script type="text/javascript">
      var parentAPI = null;
      var height = function () { return document.height || document.body.offsetHeight; };
      var foo = "foo";
      var doValidate = function () {
        setTimeout(function () {
          parentAPI.emit('validated', parentAPI.model.uid);
        }, 200);
      };
      var a = function () {
        return 'a';
      };
      var b = function () {
        return new RSVP.Promise(function (resolve, reject) {
          setTimeout(function () {
            resolve('b');
          }, 300);
        });
      };
      new Postmate.Model({ height: height, foo: foo, doValidate: doValidate, a: a, b: b })
      .then(function (parent) { parentAPI = parent; });
    </script>
  </body>
</html>
